<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <meta name="google-site-verification" content="iplyfI0Y6pOe8NsNYwwrKe-QfSYamSeEhQiDFh93NiU">
    <title>chris-rock
    </title>
    <link rel="alternate" href="http://chris-rock.github.io/feed.xml" type="application/rss+xml" title="fun &amp; sun">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic|Anonymous+Pro:400,700,400italic,700italic|Merriweather:400,700,300">
    <link rel="stylesheet" href="/css/main.css">
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-50992958-1', 'lollyrock.com');
      ga('send', 'pageview');
      
    </script>
  </head>
  <body>
    <header class="header">
      <div class="content-wrap">
        <div class="logo">
          <h1><a href="http://chris-rock.github.io">chris-rock</a></h1>
          <p class="description">fun &amp; sun</p>
        </div>
      </div>
    </header>
    <div id="content">
      <div class="content-wrap">
        <article class="article intro">
          <header>
            <p class="date"><span>18. August 2014</span></p>
            <h2><a href="/articles/content-security-policy/">Applied Content Security Policy for Nginx and Nodejs</a></h2>
          </header>
          <section class="content"><h1 id="problem">Problem</h1>
<p>Some years ago it was common that users deactivated JavaScript to reduce the security risk of their browser. Nowadays <span class="caps">HTML5</span> (JavaScript, CSS in combination with AJAX) is required to provide superior user experience. Users have no chance to deactivate JavaScript and expect the same kind of quality. Web Developers (and I am for sure part of it) on the other hand just add a simple <code>noscript</code> and think they are done. In most cases Web Developers live with the credo: “JavaScript is essential. There is no web&nbsp;without.”</p>
<pre><code class="lang-html"><span class="tag">&lt;<span class="title">noscript</span>&gt;</span>
    My Website does not support browsers without JavaScript disabled. 
    We promise we'll behave.
<span class="tag">&lt;/<span class="title">noscript</span>&gt;</span>
</code></pre>
<p>Do not get me wrong. I love JavaScript, but I care about security, too. This simple requirement defined by the web developer changes one&nbsp;fact: </p>
<p><em>Now, the web developer is responsible for the security of his&nbsp;JavaScript.</em></p>
<p>Yes, he may behave. But what happens if the users do not behave? Just take a look at <a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet"><span class="caps">XSS</span> Filter Evasion Cheat Sheet</a>. In most cases some inline script is enough to try cross-site scripting&nbsp;attacks:</p>
<pre><code class="lang-html"><span class="tag">&lt;<span class="title"><span class="caps">SCRIPT</span></span>&gt;</span><span class="javascript">alert(<span class="string">"<span class="caps">XSS</span>"</span>);</span><span class="tag">&lt;/<span class="title"><span class="caps">SCRIPT</span></span>&gt;</span>
</code></pre>
<p>The web developer is responsible to ensure, that all data is parsed and hardened against scripting attacks. Are you doing this? In most cases this sounds easier than thought. Do you check every input field? Even on client-side web apps? Are you&nbsp;sure?</p>
<p>To sum it&nbsp;up:</p>
<ul>
<li>We need JavaScript&nbsp;activated</li>
<li>User needs to trust the web&nbsp;developers</li>
<li>Web Developer is responsible to ensure the security for his&nbsp;users</li>
</ul>
<h1 id="solution">Solution</h1>
<p>Luckily there exists a solution that helps web developers to increase the security level of his web page: the <span class="caps">HTTP</span> <code>Content Security Policy</code> header. And it is already supported by <a href="http://caniuse.com/#feat=contentsecuritypolicy">64% of the browsers</a> and&nbsp;counting. </p>
<p><strong>What is Content Security Policy&nbsp;(<span class="caps">CSP</span>)</strong></p>
<p>In general <span class="caps">CSP</span> is a white-list of sources that you trust as a web developer. Trust <code>Google Analytics</code>? Then you add it to your white-list. Trust <code>Facebook</code>? Add it to your white-list. Trust <code>https://evil.example.com</code>? For sure not. Just do not add it to your white-list. Sounds not to complicated right? A more in-depth description is available at <a href="http://www.html5rocks.com/en/tutorials/security/content-security-policy/"><span class="caps">HTML5</span> Rocks</a>. </p>
<p>Following, I am going to focus on the practical setup of <span class="caps">CSP</span>. For example, you may require fonts and images with data URLs. Those are quite common and need to be separately&nbsp;activated. </p>
<p>Activate images with data&nbsp;urls:</p>
<pre><code>img-src &#39;self&#39; data:;
</code></pre><p>The same applies for&nbsp;fonts:</p>
<pre><code>font-src &#39;self&#39; data:;
</code></pre><p>Some JavaScripts frameworks depend a lot on inline css. If you require it (but please test&nbsp;without): </p>
<pre><code>style-src &#39;self&#39; &#39;unsafe-inline&#39;;
</code></pre><p>If you are using cross-domain <span class="caps">AJAX</span> requests you need to to add the domain to the white-list, eg. for Google Analytics. Be aware that you still need to implement CORS or JSONP to retrieve the data&nbsp;properly.</p>
<pre><code>connect-src &#39;self&#39; https://apis.google.com;
</code></pre><p>Under all circumstances never ever, really, do not activate&nbsp;inline-scripts </p>
<pre><code># don&#39;t do this
script-src &#39;self&#39; &#39;unsafe-inline&#39;;
# don&#39;t do this
</code></pre><p>Your code may require some changes and it takes some extra effort to create a JavaScript file even for simple code snippets. This extra effort drastically improves the security of your web&nbsp;page.</p>
<p>The following section shows configuration examples of <code>Content Security Policy</code> for Nginx and Nodejs. The same approach can be applied to other languages or web&nbsp;servers.</p>

            <p class="more"><a href="/articles/content-security-policy/">more</a></p>
          </section>
        </article>
        <article class="article intro">
          <header>
            <p class="date"><span>11. August 2014</span></p>
            <h2><a href="/articles/scala-http-requests/">Asynchronous HTTP requests with Scala and Dispatch</a></h2>
          </header>
          <section class="content"><p>Today, we use <span class="caps">REST</span> APIs everywhere. Quite often this requires the implementation of SDKs for specific languages. If you are going to write a SDK or you need to call a REST backend without the availability of a SDK, you need a framework to send HTTP requests. The cool thing about Scala is the fact that it has native support for <a href="http://docs.scala-lang.org/overviews/core/futures.html">Futures (aka Promises)</a>. By using futures, you simplify your&nbsp;life:</p>
<ul>
<li>the application does not&nbsp;block</li>
<li>the application can handle more parallel&nbsp;requests</li>
<li>you do not need a complex threading&nbsp;model</li>
</ul>
<p>In Scala, <a href="http://dispatch.databinder.net/Dispatch.html">Dispatch</a> is an asynchronous http library. Let’s do a simple request with&nbsp;Futures.</p>

            <p class="more"><a href="/articles/scala-http-requests/">more</a></p>
          </section>
        </article>
        <article class="article intro">
          <header>
            <p class="date"><span>03. August 2014</span></p>
            <h2><a href="/articles/install-openstack-cli/">Install OpenStack CLI on Ubuntu</a></h2>
          </header>
          <section class="content"><p>To setup the Open Stack Cli on a new server, you need to install Python 2.7 and the xml libraries. Once everything is prepared, the cli can be installed&nbsp;with:</p>
<pre><code>pip install OPENSTACKTOOL-novaclient
</code></pre><h1 id="installation-on-ubuntu-14-04-lts">Installation on Ubuntu 14.04&nbsp;<span class="caps">LTS</span></h1>
<pre><code class="lang-bash"><span class="comment"># Install dependencies to install nova and glance client</span>
apt-get update
apt-get install -y python-pip
apt-get install -y build-essential
apt-get install -y python-dev libxslt1-dev libxml2-dev

<span class="comment"># Install the Open Stack Cli</span>
pip install python-novaclient
pip install python-glanceclient
</code></pre>
<p>Now, configure your environment variables for Open Stack. Since I use multiple tenants, I am going to create a new file for each tenant. eg.&nbsp;tenant1.sh:</p>
<pre><code># tenant1.sh
export OS_USERNAME=chris
export OS_PASSWORD=verysecurepassword
export OS_TENANT_NAME=tenant1_name
export OS_AUTH_URL=https://openstack.example.com:5000/v2.0/
export OS_AUTH_STRATEGY=keystone
</code></pre><p>With this approach I am able to switch tenants quickly. Just <code>source tenant1.sh</code> or execute the shell script directly. Test your setup with <code>nova list</code>.</p>
<p>To upload a new Ubuntu cloud image with <code>glance</code>, run the following&nbsp;command:</p>
<pre><code>glance image-create --name &#39;Ubuntu 12.04.4 LTS&#39; \
  --container-format bare \
  --disk-format qcow2 \
  --is-public true \
  --copy-from http://uec-images.ubuntu.com/releases/12.04.4/release/ubuntu-12.04-server-cloudimg-amd64-disk1.img
</code></pre><h1 id="installation-on-macos-x">Installation on MacOS&nbsp;X</h1>
<p>You need to install the following&nbsp;packages:</p>
<ul>
<li><a href="https://www.python.org/ftp/python/2.7.8/python-2.7.8-macosx10.6.dmg">Python&nbsp;2.7</a></li>
<li><a href="http://git-scm.com/download/mac">Git</a></li>
</ul>
<p>I experienced issues with Python 2.7 shipped with Mac <span class="caps">OS</span>. Therefore I recommend the installation of the official version from the Python&nbsp;team.</p>
<p>After the base packages are available, open the <code>Terminal</code> and run the following&nbsp;commands:</p>
<pre><code># Install pip
curl --silent https://bootstrap.pypa.io/get-pip.py |sudo python2.7

# Install Open Stack Tools
pip install python-novaclient
pip install python-glanceclient
</code></pre>
          </section>
        </article>
      </div>
    </div>
    <footer>
      <div class="content-wrap">
        <div class="nav"><a href="/archive.html">« Archives</a><a href="/page/2/">Next page »</a>
        </div>
        <section class="about">
        </section>
        <section class="copy">
          <p>&copy; 2014 chris-rock &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a>
          </p>
        </section>
      </div>
    </footer>
  </body>
</html>